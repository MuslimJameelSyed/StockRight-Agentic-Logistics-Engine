# Warehouse Putaway Recommendation System

AI-powered warehouse location recommendation system with local MySQL and Ollama LLM.

---

## Overview

This system recommends optimal warehouse locations for storing parts by analyzing:
- **Historical patterns** from Qdrant Cloud vector database
- **Real-time availability** from local MySQL database
- **AI explanations** generated by local Ollama LLM

### Components
- Qdrant Cloud API - Historical putaway pattern storage
- Local MySQL (Docker) - Location availability data (87 clients, 3,215 parts, 31,416 locations)
- Local Ollama LLM (Docker) - Natural language recommendations

---

## System Requirements

**Minimum Configuration:**
- **RAM**: 4GB (8GB recommended)
- **Storage**: 10GB free disk space (20GB recommended)
- **OS**: Windows 10/11, macOS 10.15+, or Linux (Ubuntu 20.04+)
- **Docker**: Docker Desktop 4.0+ (with Docker Compose)
- **Python**: 3.8 or higher
- **Network**: Internet connection (for Qdrant Cloud API)

**Resource Breakdown:**
- MySQL Docker Container: ~500MB RAM, 2GB disk
- Ollama LLM (llama3.2): ~2GB RAM, 4GB disk
- Python Application: ~200MB RAM

---

## Deployment Steps

### Step 1: Install Prerequisites

1. **Install Docker Desktop**
   - Download: https://www.docker.com/products/docker-desktop
   - Start Docker Desktop and ensure it's running

2. **Install Python 3.8+**
   - Download: https://www.python.org/downloads/
   - Verify: `python --version`

### Step 2: Clone and Configure

```bash
# Clone the repository
git clone <your-repo-url>
cd warehouse-putaway-system

# Create .env file from example
cp .env.local.example .env

# Edit .env and add your Qdrant credentials
QDRANT_URL=https://your-cluster.cloud.qdrant.io
QDRANT_API_KEY=your-api-key-here
```

### Step 3: Start Docker Services

```bash
# Start MySQL and Ollama containers
docker-compose up -d

# Wait 30 seconds for MySQL to initialize, then verify
docker ps

# Pull the AI model (this may take 2-3 minutes)
docker exec warehouse-ollama ollama pull llama3.2
```

### Step 4: Install Python Dependencies

```bash
# Install required packages
pip install -r requirements.txt
```

### Step 5: Run the System

**Option A - Web Interface (Recommended):**
```bash
streamlit run app.py
```
Then open browser: http://localhost:8501

**Option B - Command Line:**
```bash
python warehouse_cli.py 600
```

**Total Deployment Time: 10-15 minutes**

---

## Quick Start (Summary)

For experienced users:

```bash
# 1. Setup
cp .env.local.example .env
# Edit .env with your Qdrant credentials

# 2. Start services
docker-compose up -d
docker exec warehouse-ollama ollama pull llama3.2
pip install -r requirements.txt

# 3. Run
streamlit run app.py  # Web UI at http://localhost:8501
```

---

## How It Works

1. **Query**: User provides Part ID (e.g., 600)
2. **Historical Lookup**: Retrieves past putaway patterns from Qdrant
3. **Availability Check**: Queries MySQL for current location status (FREE/OCCUPIED)
4. **Recommendation**: Returns best available location with AI-generated explanation

### Example Output

```
RECOMMENDED LOCATION: TP49A
  Status:           FREE
  Historical Usage: 2x out of 53 putaways

  ALTERNATIVES:
    1. TN43D - FREE
    2. TN49B - FREE

  AI SUMMARY: I recommend storing Part '42645EQ' in Location TP49A,
  as it aligns with our historical data and is currently available.
```

---

## Configuration

All settings in `.env`:

**Qdrant (Cloud API)**
```env
QDRANT_URL=https://your-cluster.cloud.qdrant.io
QDRANT_API_KEY=your-api-key
QDRANT_COLLECTION_NAME=PartSummary
```

**MySQL (Local Docker)**
```env
MYSQL_HOST=localhost
MYSQL_PORT=3307
MYSQL_DATABASE=mydatabase_gdpr
MYSQL_USER=muslim
MYSQL_PASSWORD=warehouse_pass_2024
```

**Ollama (Local AI)**
```env
OLLAMA_HOST=localhost
OLLAMA_PORT=11434
OLLAMA_MODEL=llama3.2
OLLAMA_TEMPERATURE=0.1
```

---

## Database

Pre-populated database auto-imports on first run:

| Table    | Records | Description                |
|----------|---------|----------------------------|
| client   | 87      | Client information         |
| part     | 3,215   | Part catalog               |
| location | 31,416  | Warehouse location status  |

**Location Status Logic:**
- `clientId = NULL` → FREE (available)
- `clientId = 123` → OCCUPIED (in use by client 123)

### Useful Commands

```bash
# Access MySQL shell
docker exec -it warehouse-mysql mysql -uroot -pwarehouse_root_2024 mydatabase_gdpr

# Check specific location
docker exec warehouse-mysql mysql -uroot -pwarehouse_root_2024 -e \
  "SELECT code, clientId FROM location WHERE code='TP49A'" mydatabase_gdpr

# Count free locations
docker exec warehouse-mysql mysql -uroot -pwarehouse_root_2024 -e \
  "SELECT COUNT(*) FROM location WHERE clientId IS NULL" mydatabase_gdpr
```

---

## Troubleshooting

### MySQL Connection Failed
```bash
docker ps | grep warehouse-mysql
docker logs warehouse-mysql
docker-compose restart mysql
```

### Ollama Not Responding
```bash
docker logs warehouse-ollama
docker-compose restart ollama
docker exec warehouse-ollama ollama pull llama3.2
```

### Port Conflict
Edit `docker-compose.yml`:
```yaml
mysql:
  ports:
    - "3308:3306"  # Change 3307 to 3308
```

Update `.env`:
```env
MYSQL_PORT=3308
```

### Qdrant Connection Failed
1. Verify credentials in `.env`
2. Check internet connection
3. Ensure collection `PartSummary` exists

---

## System Architecture

```
User Input → Qdrant Cloud → MySQL Docker → Ollama Docker → Recommendation
            (History)      (Availability) (Explanation)
```

---

## Common Commands

**Docker Management**
```bash
docker-compose up -d          # Start services
docker-compose down           # Stop services
docker-compose logs -f        # View logs
docker ps                     # Check status
```

**Ollama Models**
```bash
docker exec warehouse-ollama ollama list         # List models
docker exec warehouse-ollama ollama pull mistral # Download model
```

**Database Backup**
```bash
docker exec warehouse-mysql mysqldump -uroot -pwarehouse_root_2024 \
  mydatabase_gdpr > backup.sql
```

---

## Security Notes

- Do not commit `.env` to public repositories
- Change default MySQL password for production
- Use separate Qdrant API keys for dev/prod
- Restrict Docker ports to localhost in production

---

## File Structure

```
warehouse-putaway-system/
├── .env                    # Configuration
├── docker-compose.yml      # Docker services
├── config.py               # Configuration loader
├── warehouse_cli.py        # CLI interface
├── app.py                  # Web interface
├── requirements.txt        # Python dependencies
└── data/                   # SQL files (auto-imported)
    ├── client.sql
    ├── part.sql
    ├── location.sql
    └── import_all.sql
```
